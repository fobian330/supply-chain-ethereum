<!DOCTYPE html>

<head>
    <title>Blockchain</title>
    <script src="https://code.jquery.com/jquery-3.4.1.js"
        integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/gh/ethereum/web3.js@1.2.6/dist/web3.min.js"></script>
    <script type="text/javascript">
        var contract;
        var address = "0xb96c0f28aec3e897ba329e86368045a15d47cf3e";
        var abi = [
            {
                "inputs": [
                    {
                        "internalType": "string",
                        "name": "_firstname",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "_lastname",
                        "type": "string"
                    },
                    {
                        "internalType": "int256",
                        "name": "_marks",
                        "type": "int256"
                    }
                ],
                "name": "addNewRecord",
                "outputs": [],
                "stateMutability": "nonpayable",
                "type": "function"
            },
            {
                "inputs": [],
                "stateMutability": "nonpayable",
                "type": "constructor"
            },
            {
                "inputs": [
                    {
                        "internalType": "int256",
                        "name": "_id",
                        "type": "int256"
                    }
                ],
                "name": "getFirstNameById",
                "outputs": [
                    {
                        "internalType": "string",
                        "name": "",
                        "type": "string"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "int256",
                        "name": "_id",
                        "type": "int256"
                    }
                ],
                "name": "getLastNameById",
                "outputs": [
                    {
                        "internalType": "string",
                        "name": "",
                        "type": "string"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "int256",
                        "name": "_id",
                        "type": "int256"
                    }
                ],
                "name": "getMarksById",
                "outputs": [
                    {
                        "internalType": "int256",
                        "name": "",
                        "type": "int256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [],
                "name": "studentCount",
                "outputs": [
                    {
                        "internalType": "int256",
                        "name": "",
                        "type": "int256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            },
            {
                "inputs": [
                    {
                        "internalType": "int256",
                        "name": "",
                        "type": "int256"
                    }
                ],
                "name": "studentRecords",
                "outputs": [
                    {
                        "internalType": "int256",
                        "name": "_id",
                        "type": "int256"
                    },
                    {
                        "internalType": "string",
                        "name": "_firstname",
                        "type": "string"
                    },
                    {
                        "internalType": "string",
                        "name": "_lastname",
                        "type": "string"
                    },
                    {
                        "internalType": "int256",
                        "name": "marks",
                        "type": "int256"
                    }
                ],
                "stateMutability": "view",
                "type": "function"
            }
        ]

        web3 = new Web3(web3.currentProvider);
        contract = new web3.eth.Contract(abi, address);

        $(document).ready(function () {
            $("#_show").click(function () {
                var student_id = parseInt($("#_id").val());
                contract.methods.getFirstNameById(student_id).call().then(function (name) {
                    $("#_fname").val(name);
                });
                contract.methods.getLastNameById(student_id).call().then(function (name) {
                    $("#_lname").val(name);
                });
                contract.methods.getMarksById(student_id).call().then(function (name) {
                    $("#_marks").val(name);
                });
            });

            $("#_add").click(function () {
                web3.eth.getAccounts().then(function (accounts) {
                    var account = accounts[0];

                    var fname = $("#_fname").val();
                    var lname = $("#_lname").val();
                    var marks = $("#_marks").val();

                    return contract.methods.addNewRecord(fname, lname, marks).send({ from: account });
                }).then(function (trx) {
                    console.log(trx);
                    alert("Student details added");
                });
            });

        });
    </script>
    <style type="text/css">
        div {
            margin-left: 36%;
            margin-top: 10%;
        }
    </style>
</head>

<body>
    <div>
        <label for="id">Student ID : </label>
        <input type="text" id="_id" name="id">
        <input type="submit" value="SHOW" id="_show"><br><br>

        <label for="fname">First Name : </label>
        <input type="text" id="_fname" name="fname"><br><br>

        <label for="lname">Last Name : </label>
        <input type="text" id="_lname" name="lname"><br><br>

        <label for="marks">Marks : </label>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <input type="text" id="_marks" name="marks"><br><br>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <input type="submit" value="ADD" id="_add">
    </div>
</body>

</html>